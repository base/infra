version:
  format: 1
  binary: 0.13.2

workflows:
  check:
    - [
        "lint",
        # Check that `A` activates the features of `B`.
        "propagate-feature",
        # These are the features to check:
        "--features=std,serde",
        # Do not try to add a new section into `[features]` of `A` only because `B` exposes that feature.
        "--left-side-feature-missing=ignore",
        # Ignore the case that `A` is outside of the workspace.
        "--left-side-outside-workspace=ignore",
        # Only check normal dependencies.
        "--dep-kinds=normal:check,dev:ignore",
        "--show-path",
        "--quiet",
      ]
  default:
    # Running `zepter` with no subcommand will check & fix.
    - [$check.0, "--fix"]

# Will be displayed when any workflow fails:
help:
  text: |
    This repository uses the Zepter CLI to detect abnormalities in Cargo features, e.g. missing propagation.

    It looks like one or more checks failed; please check the console output.

    You can try to automatically address them by installing zepter (`cargo install zepter --locked`) and simply running `zepter` in the workspace root.
  links:
    - "https://github.com/ggwpez/zepter"
